<div class="card shadow-sm">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-center mb-2 stability-header-row">
      <h5 class="card-title mb-0">Stability &amp; Variance</h5>
      <button type="button" class="btn btn-outline-secondary btn-sm stability-back-btn" (click)="goBack()">
        Back to Home
      </button>
    </div>

    <p class="text-muted small mb-3">
      Analyses run-to-run stability and variance in estimation and response time across AI models.
    </p>

    <div *ngIf="isLoading" class="small text-muted">Loading stability analysis...</div>
    <div *ngIf="error" class="text-danger small">{{ error }}</div>

    <div *ngIf="result">
      <div class="row g-3 stability-row">
          <div class="col-md-6 stability-left-col">
            <h6 class="small text-muted variance-comparison-title">Variance comparison by provider (s)</h6>
        <app-grouped-bar-chart
          *ngIf="varianceCategories.length"
          [categories]="varianceCategories"
          [seriesALabel]="'Estimation variance'"
          [seriesBLabel]="'Response time variance'"
          [seriesAValues]="estimationVariancePerProvider"
          [seriesBValues]="responseTimeVariancePerProvider"
        ></app-grouped-bar-chart>
        </div>
          <div class="col-md-6 stability-right-col">
            <h6 class="small text-muted variance-summary-title">Variance summary (s)</h6>
        <div class="variance-summary-wrapper">
          <app-variance-chart [variances]="varianceSummary"></app-variance-chart>
        </div>
        </div>
      </div>

      <p class="chart-caption small text-muted mt-2">
        Figure: Stability and variance profile of AI estimations and response times across repeated experiments.
      </p>

      <h6 class="mt-3">Raw Stability Metrics</h6>
      <pre class="small bg-light p-2 border rounded">{{ result | json }}</pre>
    </div>
  </div>
</div>
