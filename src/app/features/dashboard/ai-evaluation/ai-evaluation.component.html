<!-- ...existing code... -->


<!-- Main evaluation card content ... -->

<div class="container mt-4 ai-evaluation-page ai-comparison-page">
  <h2 class="mb-3 ai-evaluation-title">Evaluation Analysis</h2>
  <p class="text-muted mb-4">High-level insights: How good is the AI? Which model performs better?</p>

  <div class="mb-2 d-flex justify-content-end">
    <button class="btn btn-outline-secondary btn-sm evaluation-back-btn" (click)="goBack()">
      ‚Üê Back to AI Estimations
    </button>
  </div>

  <div class="evaluation-controls-shell">
    <app-ai-evaluation-controls
      class="mb-3"
      [activeTab]="activeEvaluationTab"
      [isLoading]="isLoadingEvaluation"
      [evalIssueKey]="evalIssueKey"
      (evalIssueKeyChange)="evalIssueKey = $event"
      [evalProvider]="evalProvider"
      (evalProviderChange)="evalProvider = $event"
      [stabilityIssueKey]="stabilityIssueKey"
      (stabilityIssueKeyChange)="stabilityIssueKey = $event"
      (runRequested)="runEvaluation()"
      (tabChange)="selectTab($event)">
    </app-ai-evaluation-controls>
  </div>

  <div class="chart-stack" *ngIf="evaluationResult">
    <ng-container [ngSwitch]="activeEvaluationTab">
      <ng-container *ngSwitchCase="'by-issue'">
        <app-ai-eval-by-issue
          [hasProviderStats]="hasProviderStats"
          [maxProviderAvgHours]="maxProviderAvgHours"
          [providerBarData]="providerBarData"
          [providerBarOptions]="providerBarOptions"
          [providerBarType]="providerBarType"
          [byIssueTimeBarData]="byIssueTimeBarData"
          [byIssueTimeBarOptions]="byIssueTimeBarOptions"
          [byIssueTimeBarType]="byIssueTimeBarType"
          [byIssueAllStatsBarData]="byIssueAllStatsBarData"
          [byIssueAllStatsBarOptions]="byIssueAllStatsBarOptions"
          [byIssueAllStatsBarType]="byIssueAllStatsBarType"
          [byIssueOverallBarData]="byIssueOverallBarData"
          [byIssueOverallBarOptions]="byIssueOverallBarOptions"
          [byIssueOverallBarType]="byIssueOverallBarType">
        </app-ai-eval-by-issue>
      </ng-container>

      <ng-container *ngSwitchCase="'comparison'">
        <app-ai-eval-model-comparison
          [comparisonPerfAvgBarData]="comparisonPerfAvgBarData"
          [comparisonPerfAvgBarOptions]="comparisonPerfAvgBarOptions"
          [comparisonPerfAvgBarType]="comparisonPerfAvgBarType"
          [comparisonPerfDetailBarData]="comparisonPerfDetailBarData"
          [comparisonPerfDetailBarOptions]="comparisonPerfDetailBarOptions"
          [comparisonPerfDetailBarType]="comparisonPerfDetailBarType">
        </app-ai-eval-model-comparison>
      </ng-container>

      <ng-container *ngSwitchCase="'by-model'">
        <app-ai-eval-by-model
          [modelByModelPieData]="modelByModelPieData"
          [modelByModelPieOptions]="modelByModelPieOptions"
          [modelByModelPieType]="modelByModelPieType"
          [modelByModelBarData]="modelByModelBarData"
          [modelByModelBarOptions]="modelByModelBarOptions"
          [modelByModelBarType]="modelByModelBarType">
        </app-ai-eval-by-model>
      </ng-container>

      <ng-container *ngSwitchCase="'features'">
        <app-ai-eval-feature-impact
          [markdownEnabledPieData]="markdownEnabledPieData"
          [markdownDisabledPieData]="markdownDisabledPieData"
          [markdownPieOptions]="markdownPieOptions"
          [markdownPieType]="markdownPieType"
          [markdownBarData]="markdownBarData"
          [markdownBarOptions]="markdownBarOptions"
          [markdownBarType]="markdownBarType">
        </app-ai-eval-feature-impact>
      </ng-container>

      <ng-container *ngSwitchCase="'stability'">
        <app-ai-eval-stability
          [issueLabel]="stabilityIssueLabel"
          [stabilityBarData]="stabilityBarData"
          [stabilityBarOptions]="stabilityBarOptions"
          [stabilityBarType]="stabilityBarType"
          [stabilityLineData]="stabilityLineData"
          [stabilityLineOptions]="stabilityLineOptions"
          [stabilityLineType]="stabilityLineType"
          [stabilityPieData]="stabilityPieData"
          [stabilityPieOptions]="stabilityPieOptions"
          [stabilityPieType]="stabilityPieType"
          [stabilityRadarData]="stabilityRadarData"
          [stabilityRadarOptions]="stabilityRadarOptions"
          [stabilityRadarType]="stabilityRadarType">
        </app-ai-eval-stability>
      </ng-container>
    </ng-container>
  </div>

  <div class="chart-card raw-result-card mt-3" *ngIf="evaluationResult">
    <h5 class="chart-title mb-2">Raw Evaluation Result</h5>
    <pre class="small mb-0">{{ evaluationResult | json }}</pre>
  </div>
</div>
