<div class="issues-container">
  <div class="issues-header">
    <div class="header-content">
      <h2 class="page-title">Issues - {{ projectKey }}</h2>
      <p class="page-subtitle">All issues and bugs for this project</p>
    </div>
    <button class="btn btn-secondary" (click)="goBack()">â† Back to Projects</button>
  </div>

  <div class="filters-section">
    <div class="search-box">
      <input type="text" class="search-input" placeholder="Search by issue key or summary..." #searchInput (input)="onSearchChange(searchInput.value)" />
    </div>
    <div class="filter-controls">
      <select class="filter-select" #statusFilter (change)="onStatusFilterChange(statusFilter.value)">
        <option value="">All Status</option>
        <option value="todo">To Do</option>
        <option value="progress">In Progress</option>
        <option value="done">Done</option>
      </select>
      <select class="filter-select" #priorityFilter (change)="onPriorityFilterChange(priorityFilter.value)">
        <option value="">All Priorities</option>
        <option value="high">High</option>
        <option value="medium">Medium</option>
        <option value="low">Low</option>
      </select>
    </div>
  </div>

  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3">Loading issues...</p>
  </div>

  <div *ngIf="!isLoading && errorMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
    <strong>Error:</strong> {{ errorMessage }}
    <button type="button" class="btn-close" (click)="errorMessage = ''"></button>
  </div>

  <div *ngIf="!isLoading && filteredIssues.length === 0 && issues.length === 0 && !errorMessage" class="empty-state">
    <div class="empty-state-icon">ğŸ›</div>
    <h4>No Issues Found</h4>
    <p>There are no issues or bugs for this project.</p>
  </div>

  <div *ngIf="!isLoading && filteredIssues.length === 0 && issues.length > 0 && !errorMessage" class="empty-state">
    <div class="empty-state-icon">ğŸ”</div>
    <h4>No Results</h4>
    <p>No issues match your filter criteria. Try adjusting your search.</p>
  </div>

  <div *ngIf="!isLoading && filteredIssues.length > 0" class="issues-list">
    <div *ngFor="let issue of filteredIssues" class="issue-card">
      <div class="issue-header">
        <div class="issue-key-section">
          <h3 class="issue-key">{{ issue.key }}</h3>
          <span class="issue-type" [title]="issue.fields?.issuetype?.description">{{ issue.fields?.issuetype?.name }}</span>
        </div>
        <div class="issue-badges">
          <span class="badge" [ngClass]="getStatusClass(issue.fields?.status?.name)">{{ issue.fields?.status?.name }}</span>
          <span class="badge" [ngClass]="getPriorityClass(issue.fields?.priority?.name)">{{ issue.fields?.priority?.name }}</span>
        </div>
      </div>

      <div class="issue-summary">
        <h4>{{ issue.fields?.summary }}</h4>
      </div>

      <div class="issue-details">
        <div class="detail-row">
          <span class="label">Description:</span>
          <span class="value">{{ issue.fields?.description || 'No description provided' }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Assignee:</span>
          <span class="value">{{ issue.fields?.assignee?.displayName || 'Unassigned' }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Reporter:</span>
          <span class="value">{{ issue.fields?.reporter?.displayName || 'Unknown' }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Created:</span>
          <span class="value">{{ issue.fields?.created | slice:0:10 }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Updated:</span>
          <span class="value">{{ issue.fields?.updated | slice:0:10 }}</span>
        </div>
        <div class="detail-row" *ngIf="issue.fields?.duedate">
          <span class="label">Due Date:</span>
          <span class="value">{{ issue.fields?.duedate }}</span>
        </div>
      </div>

      <div class="issue-footer">
        <div class="issue-meta">
          <span class="meta-item">
            <span class="meta-label">Comments:</span>
            <span class="meta-value">{{ issue.fields?.comment?.comments?.length || 0 }}</span>
          </span>
        </div>
        <div class="issue-actions">
          <button class="btn btn-primary btn-sm" (click)="viewDetails(issue)">ğŸ“‹ View Details</button>
          <button
            class="btn btn-outline-danger btn-sm ms-2"
            type="button"
            (click)="deleteIssue(issue)"
            [disabled]="deletingIssueKey === issue.key"
          >
            ğŸ—‘ Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && filteredIssues.length > 0" class="results-count">Showing {{ filteredIssues.length }} of {{ issues.length }} issues</div>

  <div class="back-button-container mt-4">
    <button class="btn btn-secondary" (click)="goBack()">â† Back to Projects</button>
  </div>
</div>
